# 哈希算法

## 定义及特性

哈希算法是一种将任意长度的输入转换为固定长度输出的算法，具有以下特性：

1. **不可逆性**：无法通过哈希值还原原始输入。
2. **抗碰撞性**：不同的输入不应产生相同的哈希值。
3. **固定长度输出**：任意长度的输入转换为固定长度的输出。
4. **高效性**：算法执行速度快，适合大规模数据处理。

---

## 应用场景

### 1. 快速查找
利用哈希表实现高效的数据查找，常用于数据库索引和缓存系统。

### 2. 数据校验
通过哈希值验证数据完整性，确保数据在传输或存储过程中未被篡改。

### 3. 密码存储
利用哈希算法的不可逆性，安全存储用户密码，结合加盐技术增强安全性。

### 4. 区块链
用于区块链中的数据完整性验证和工作量证明，确保区块数据不可篡改。

### 5. 数字签名
在数字签名中，哈希算法用于生成消息摘要，确保消息的完整性和真实性。

---

## 核心原理

### 1. 单向性
- **信息压缩**：将长信息压缩成固定长度输出，导致信息丢失。
  - **鸽巢原理**：输入组合多于输出数量时，必然存在哈希冲突。
- **不可逆操作**：
  - 使用非线性混合、位移、模运算等方法，确保无法还原原始输入。

### 2. 固定长度输出
- **填充与裁剪**：
  - 输入不足特定长度时，进行填充（如 SHA-256 的填充规则）。
  - 输入过长时，反复压缩至固定大小。
- **SHA-256 示例**：
  - 模 2³² 计算（32-bit 截断）确保输出为 256-bit。

### 3. 抗碰撞性
- **乘法放大效应**：输入差异通过多次迭代放大，降低冲突概率。
- **随机性增强**：通过复杂的混合操作，确保输出的随机性。

---

## 分类

### 1. 密码学哈希函数
- **用途**：密码存储、数字签名、区块链等。
- **特点**：
  - 抗碰撞性、抗篡改性、不可逆性。
  - 几乎无法找到两个不同输入产生相同哈希值。
- **典型算法**：SHA-256、SHA-3、BLAKE2 等（MD5 和 SHA-1 已被认为不安全）。

### 2. 非密码学哈希函数
- **用途**：快速查找、负载均衡、数据去重等。
- **特点**：
  - 对安全性要求低，但计算速度快、冲突率低。
  - 允许一定概率的哈希冲突。
- **典型算法**：MurmurHash、CityHash、FNV、xxHash。

---

## 常见问题

### 1. 为什么能防止数据篡改？
- 不同输入对应不同输出，数据被篡改时，哈希值会发生变化，能快速检测篡改。

### 2. 为什么能快速查找？
- 输入通过哈希算法转换为固定输出，作为查找索引。
  - **计算快**：哈希算法效率高。
  - **范围有限**：输出空间固定，便于快速定位。

### 3. 为什么 MD5 和 SHA-1 不再安全？
- 随着计算能力的提升，已能找到碰撞攻击的实例，无法满足现代安全需求。

---

## 延伸阅读

### 常见哈希算法
- djb2 hash
- CRC32
- One at a time Hash
- FNV hash
- MurmurHash

### 哈希算法模型
大多数哈希算法可以抽象为以下模型：
```text
initialize(internal state)
for (each text block)
{
  combine(internal state, text block);
  mix(internal state);
}
return postprocess(internal state);
```

https://burtleburtle.net/bob/hash/doobs.html
https://www.azillionmonkeys.com/qed/hash.html

---

## 相关概念

### 哈希冲突
- **定义**：不同的输入产生相同的哈希值。
- **解决方法**：
  - **开放地址法**：在冲突位置寻找下一个空闲位置。
  - **链地址法**：将冲突的元素存储在链表中。

### 压缩函数
哈希算法中的压缩函数是实现固定长度输出的关键，常用的压缩函数包括：
- **MD 系列**：基于 Merkle-Damgård 结构。
- **SHA 系列**：基于 Sponge 结构（如 SHA-3）。

### 线性与非线性操作

#### 线性操作
- 加法
- 乘以常数

#### 非线性操作
- 平方函数
- 变量间相乘
- 进位效应

---

## 总结

哈希算法在现代计算中具有广泛的应用，从数据校验到密码存储，再到区块链和数字签名。理解其核心原理和特性，有助于更好地选择和使用合适的哈希算法。
